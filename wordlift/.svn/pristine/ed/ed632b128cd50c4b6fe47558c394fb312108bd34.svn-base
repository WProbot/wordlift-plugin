{"version":3,"file":"wordlift-admin.bundle.js","sources":["webpack:///webpack/bootstrap 6c00de0e2d26f0eec9f4?5a3f*","webpack:///src/admin/js/modules/wordlift.js","webpack:///src/admin/js/wordlift-admin.js","webpack:///src/admin/js/modules/check.js","webpack:///src/admin/js/modules/delay.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 113);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6c00de0e2d26f0eec9f4","window.wp = window.wp || {};\nwindow.wp.wordlift = window.wp.wordlift || {};\n\nif ( typeof window.wp.wordlift.trigger === 'undefined' ) {\n\t_.extend( window.wp.wordlift, Backbone.Events );\n}\n\nexport default window.wp.wordlift;\n\n\n\n// WEBPACK FOOTER //\n// src/admin/js/modules/wordlift.js","/**\n * Define our global hooks.\n *\n * @since 3.0.0\n */\n\n/**\n * Internal dependencies\n */\n// eslint-disable-next-line no-unused-vars\nimport wordlift from './modules/wordlift';\nimport delay from './modules/delay';\nimport check from './modules/check';\n\n(\n\tfunction( $ ) {\n\t\t/**\n\t\t * Execute when the document is ready.\n\t\t *\n\t\t * @since 3.1.0\n\t\t */\n\t\t$( function() {\n\t\t\t// The Entity Types Taxonomy is exclusive, one cannot choose more\n\t\t\t// than a type. Therefore from the PHP code we provide a Walker\n\t\t\t// that changes checkboxes into radios. However the quickedit on the\n\t\t\t// client side is applied only to checkboxes, so we override the\n\t\t\t// function here to apply the selection also to radios.\n\n\t\t\t// Do not hook, if we're not on a page with the inlineEditPost.\n\t\t\tif ( 'undefined' === typeof inlineEditPost || null === inlineEditPost ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Create a reference to the original function.\n\t\t\tconst fnEdit = inlineEditPost.edit;\n\n\t\t\t// Override the edit function.\n\t\t\tinlineEditPost.edit = function( id ) {\n\t\t\t\t// Call the original function.\n\t\t\t\tfnEdit.apply( this, arguments );\n\n\t\t\t\t// Get the id (this is a copy of what happens in the original\n\t\t\t\t// edit function).\n\t\t\t\tif ( typeof(\n\t\t\t\t\t\tid\n\t\t\t\t\t) === 'object' ) {\n\t\t\t\t\tid = this.getId( id );\n\t\t\t\t}\n\n\t\t\t\t// Get a reference to the row data (holding the post data) and\n\t\t\t\t// to the newly displayed inline edit row.\n\t\t\t\tconst rowData = $( '#inline_' + id );\n\t\t\t\tconst editRow = $( '#edit-' + id );\n\n\t\t\t\t// Select the terms for the taxonomy (this is a copy of the\n\t\t\t\t// original lines in the edit function but we're targeting\n\t\t\t\t// radios instead of checkboxes).\n\t\t\t\t$( '.post_category', rowData ).each( function() {\n\t\t\t\t\tconst terms = $( this ).text();\n\n\t\t\t\t\tif ( terms ) {\n\t\t\t\t\t\tconst taxname = $( this ).attr( 'id' ).replace( '_' + id, '' );\n\t\t\t\t\t\t// Target radios (instead of checkboxes).\n\t\t\t\t\t\t$( 'ul.' + taxname + '-checklist :radio', editRow )\n\t\t\t\t\t\t\t.val( terms.split( ',' ) );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\t\t} );\n\n\t\t/**\n\t\t * Handle the alternative labels, by providing an 'Add more titles'\n\t\t * button and input texts where to add the labels.\n\t\t *\n\t\t * @since 3.2.0\n\t\t */\n\t\t$( function() {\n\t\t\t// Add the delete button to the existing input texts.\n\t\t\t$( '.wl-alternative-label > .wl-delete-button' ).on( 'click', function( event ) {\n\t\t\t\t$( event.delegateTarget ).parent().remove();\n\t\t\t} );\n\n\t\t\t// Handle the click on the 'Add more titles' button and bind the\n\t\t\t// event of the (new) delete button.\n\t\t\t$( '#wl-add-alternative-labels-button' ).on( 'click', function( event ) {\n\t\t\t\t$( event.delegateTarget ).before( function() {\n\t\t\t\t\tconst $element = $( $( '#wl-tmpl-alternative-label-input' ).html() );\n\t\t\t\t\t$element.children( '.wl-delete-button' ).on( 'click', function() {\n\t\t\t\t\t\t$element.remove();\n\t\t\t\t\t} );\n\t\t\t\t\treturn $element;\n\t\t\t\t} );\n\t\t\t} );\n\t\t} );\n\n\t\t/**\n\t\t * Check for duplicate title/labels via AJAX while the user is typing.\n\t\t *\n\t\t * @since 3.2.0\n\t\t */\n\t\t$( function() {\n\t\t\t// return if we are not in the entity editor page (the *wlSettings*\n\t\t\t// json is only enqueued there) wlSettings.entityBeingEdited comes\n\t\t\t// from `wp_localize_script`, so '1' (true) or '' (false).\n\t\t\tif ( typeof wlSettings === 'undefined' || '1' !== wlSettings.entityBeingEdited ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Print error message in page and hide it.\n\t\t\tconst duplicatedEntityErrorDiv = $( '<div class=\"wl-notice notice wl-suggestion\"' +\n\t\t\t\t\t\t\t\t\t\t\t\t' id=\"wl-same-title-error\" ><p></p></div>' )\n\t\t\t\t.insertBefore( 'div.wrap [name=post]' )\n\t\t\t\t.hide();\n\n\t\t\t/**\n\t\t\t * Check whether the specified title is already used by other\n\t\t\t * entities.\n\t\t\t *\n\t\t\t * @since 3.10.0\n\t\t\t */\n\t\t\tconst callback = function() {\n\t\t\t\t// A jQuery reference to the element firing the event.\n\t\t\t\tconst $this = $( this );\n\n\t\t\t\t// Delay execution of the check.\n\t\t\t\tdelay( $this, check, $, wp.ajax, $this.val(), wlSettings.post_id,\n\t\t\t\t\t   wlSettings.l10n[ 'You already published an entity with the same name' ],\n\t\t\t\t\t   function( html ) {\n\t\t\t\t\t\t   // Set the error div content.\n\t\t\t\t\t\t   $( '#wl-same-title-error p' ).html( html );\n\n\t\t\t\t\t\t   // If the html code isn't empty then show the error.\n\t\t\t\t\t\t   if ( '' !== html ) {\n\t\t\t\t\t\t\t   duplicatedEntityErrorDiv.show();\n\t\t\t\t\t\t   } else {\n\t\t\t\t\t\t\t   // If the html code is empty, hide the error div.\n\t\t\t\t\t\t\t   duplicatedEntityErrorDiv.hide();\n\t\t\t\t\t\t   }\n\t\t\t\t\t   } );\n\t\t\t};\n\n\t\t\t// Whenever something happens in the entity title...\n\t\t\t$( '[name=post_title]' )\n\t\t\t\t.on( 'change paste keyup', callback )\n\t\t\t\t.each( callback );\n\t\t} );\n\n\t\t/**\n\t\t * Draw dashboard if needed\n\t\t *\n\t\t * @since 3.4.0\n\t\t */\n\t\t$( function() {\n\t\t\t// return if not needed\n\t\t\tif ( ! $( '#wl-dashboard-widget-inner-wrapper' ).length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.getJSON( ajaxurl + '?action=wordlift_get_stats', function( stats ) {\n\t\t\t\t// Get the triples, 0 by default if triples is not a number.\n\t\t\t\tconst triples = isNaN( stats.triples ) ? 0 : stats.triples;\n\n\t\t\t\t// Calculate wikidata ratio\n\t\t\t\t// TODO percentage should be added via css\n\t\t\t\tconst percent = triples * 100 / 947690143;\n\t\t\t\tstats.wikidata = percent.toFixed( 5 ) + '%';\n\t\t\t\t// Calculate annotated posts ratio\n\t\t\t\tconst annotated = stats.annotated_posts * 100 / stats.posts;\n\t\t\t\tstats.annotatedPostsPercentage = annotated.toFixed( 1 );\n\t\t\t\t// Convert NaN to zero if needed\n\t\t\t\t//\n\t\t\t\t// See https://github.com/insideout10/wordlift-plugin/issues/269\n\t\t\t\tstats.annotatedPostsPercentage = stats.annotatedPostsPercentage || 0;\n\t\t\t\t// TODO percentage should be added via css\n\t\t\t\tstats.annotatedPostsPercentage = stats.annotatedPostsPercentage + '%';\n\n\t\t\t\t// Populate annotated posts pie chart\n\t\t\t\t$( '#wl-posts-pie-chart circle' ).css(\n\t\t\t\t\t'stroke-dasharray',\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tstats.annotated_posts * 100\n\t\t\t\t\t\t) / stats.posts\n\t\t\t\t\t) + ' 100'\n\t\t\t\t);\n\t\t\t\t// Populate avarage entity ratings gauge chart\n\t\t\t\t$( '#wl-entities-gauge-chart .stat' ).css(\n\t\t\t\t\t'stroke-dasharray',\n\t\t\t\t\t(\n\t\t\t\t\t\tstats.rating / 2\n\t\t\t\t\t) + ' 100'\n\t\t\t\t);\n\n\t\t\t\t// TODO percentage should be added via css\n\t\t\t\tstats.rating = stats.rating + '%';\n\t\t\t\t// populate value placeholders\n\t\t\t\tfor ( const property in stats ) {\n\t\t\t\t\t$( '#wl-dashboard-widget-' + property ).text( stats[ property ] );\n\t\t\t\t}\n\n\t\t\t\t// Finally show the widget\n\t\t\t\t$( '#wl-dashboard-widget-inner-wrapper' ).show();\n\n\t\t\t\t// Set the same height for stat graph wrappers\n\t\t\t\t// Links not working with css alternatives\n\t\t\t\tlet minHeight = 0;\n\t\t\t\t$( '.wl-stat-graph-wrapper' ).each( function() {\n\t\t\t\t\tconst stat = $( this );\n\t\t\t\t\tif ( stat.height() > minHeight ) {\n\t\t\t\t\t\tminHeight = stat.height();\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t$( '.wl-stat-graph-wrapper' ).css( 'min-height', minHeight );\n\t\t\t} );\n\t\t} );\n\t}\n)( jQuery );\n\n\n\n// WEBPACK FOOTER //\n// src/admin/js/wordlift-admin.js","/**\n * Check for duplicate titles.\n *\n * @since 3.10.0\n *\n * @param {Object} $ A jQuery instance.\n * @param {Object} ajax A `wp.ajax` class used to perform `post` requests to `admin-ajax.php`.\n * @param {String} title The title to check for duplicates.\n * @param {Number} postId The current post id, excluded from the duplicates results.\n * @param {String} message The error message to display in case there are duplicates.\n * @param {Function} callback A callback function to call to deliver the results.\n */\n\nexport default function check( $, ajax, title, postId, message, callback ) {\n\t// Use `wp.ajax` to post a request to find an existing entity with the specified title.\n\tajax.post( 'entity_by_title', { title: title } ).done( function( response ) {\n\t\t// Prepare the html code to show in the error div.\n\t\tconst html = $.map( response.results, function( item ) {\n\t\t\t// If the item is the current post, ignore it.\n\t\t\tif ( item.id === postId ) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\t// Create the edit link.\n\t\t\tconst editLink = response.edit_link.replace( '%d', item.id );\n\n\t\t\t// Return the html code.\n\t\t\treturn message + '<a target=\"_blank\" href=\"' + editLink + '\">' +\n\t\t\t\t   item.title + '</a><br />';\n\t\t} ).join( '' ); // Join the html codes together.\n\n\t\t// Call the callback function.\n\t\tcallback( html );\n\t} );\n}\n\n\n\n// WEBPACK FOOTER //\n// src/admin/js/modules/check.js","/**\n * Delay a function call by half a second.\n *\n * Any function can be delayed using `delay`. The timeout for the call is bound\n * to the provided element. If another function call is delayed on the same\n * element, any previous timeout is cancelled.\n *\n * This function is used to validate in real-time inputs when the user presses a\n * key, but allowing the user to press more keys (hence the delay).\n *\n * @since 3.9.0\n *\n * @param {Object} $elem A jQuery element reference which will hold the timeout\n *                       reference.\n * @param {Function} fn The function to call.\n * @param {...} args Parameters to pass to the callback.\n */\n\nexport default function delay( $elem, fn, ...args ) {\n\t// Clear a validation timeout.\n\tclearTimeout( $elem.data( 'timeout' ) );\n\n\t// Validate the key, after a delay, so that another key is pressed, this\n\t// validation is cancelled.\n\t$elem.data( 'timeout', setTimeout( fn, 500, ...args ) );\n}\n\n\n\n// WEBPACK FOOTER //\n// src/admin/js/modules/delay.js"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;A;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACPA;;;;;;AAMA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAQA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACxNA;AAAA;;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AClCA;AAAA;;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AACA;AAKA;AACA;;;;A","sourceRoot":""}